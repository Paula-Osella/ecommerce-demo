---
interface Props {
  product: {
    id: string;
    name: string;
    category: string;
    description: string;
    image: string;
    price?: number;
  };
}

const { product } = Astro.props;

// ðŸ”¹ AjustÃ¡ esto a gusto
const MAX_CHARS = 130;

// ðŸ”¹ Recorta sin cortar palabras al medio
function truncate(text: string, max = MAX_CHARS) {
  if (!text) return "";
  if (text.length <= max) return text;

  const cut = text.slice(0, max);
  const lastSpace = cut.lastIndexOf(" ");
  return cut.slice(0, lastSpace > 0 ? lastSpace : max) + "...";
}

const shortDesc = truncate(product.description);
---

<article class="group flex flex-col product-card">
  <a href={`/product/${product.id}`} class="block mb-3">
    <div class="product-card-image">
      <img
        src={product.image}
        alt={product.name}
        loading="lazy"
      />
    </div>
  </a>

  <div class="flex flex-col product-card-text">
    <a href={`/product/${product.id}`} class="text-sm font-semibold text-zinc-900 mb-1">
      {product.name}
    </a>

    <p class="text-xs text-gray-600">
      {shortDesc}
    </p>
  </div>
</article>
